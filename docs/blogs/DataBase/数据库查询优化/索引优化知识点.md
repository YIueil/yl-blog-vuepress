---
date: 2025-07-04 17:25:04
pageClass: blue-archive
tags:
  - 优化
categories:
  - DataBase
---

# 索引优化知识点
## 1 什么是索引
本质是高效查找数据的数据结构，如B+树，类比书籍目录。核心作用是加速数据检索，避免全表扫描。

## 2 什么时候需要建立索引，哪些字段需要作为索引

| **场景**           | **说明**                              | **反例**           |
| ---------------- | ----------------------------------- | ---------------- |
| **WHERE高频字段**    | 频繁作为查询条件的列（如`user_id`）              | 极少使用的状态字段        |
| **JOIN连接键**      | 表关联字段（如`order.customer_id`）         | 不参与关联的字段         |
| **排序字段**         | `ORDER BY` 常用列（如`create_time DESC`） | 随机排序的字段          |
| **高区分度字段**       | 基数（Cardinality）高的列（如手机号 vs 性别）      | 布尔值、枚举值（区分度<10%） |
| **覆盖索引场景**       | 查询可通过索引直接返回数据（避免回表）                 | `SELECT *` 查询    |
| **数据量 > 10%表总量** | 大数据量过滤时生效（否则优化器可能选全表扫描）             | 小表（<1万行）         |

## 3 如何建立索引
- 对于一般情况下，建立普通索引。
- 如果想要避免回表，直接建立联合索引。联合索引建立遵循**最左原则*。
	- 最左原则示例：INDEX idx_name_age (name, age) 
		- WHERE name = 'Alice'          -- √ 生效
		- WHERE name = 'Bob' AND age>25 -- √ 生效
		- WHERE age = 30                -- ✘ 不生效
- 对于大字符串类型的字段，建立**前缀索引**。
	- 文本过长时取前N字符（需平衡区分度）：`ALTER TABLE users ADD INDEX idx_email_prefix(email(20));`
## 4 索引的维护